# ä½¿ç”¨ Docker éƒ¨ç½² Ollama

## 1 æ£€æŸ¥ `nvidia-smi` æ˜¯å¦æ­£å¸¸

> è¦ä½¿ç”¨ `nvidia-smi` éœ€è¦å…ˆå®‰è£…Nvidiaé©±åŠ¨
>
> å®‰è£…å‘½ä»¤: `sudo apt-get install nvidia-driver-<version>`
>
> å®‰è£…æ–‡æ¡£ [åœ°å€](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html#installation)

```shell
âœ nvidia-smi
Fri Mar 28 02:44:18 2025
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.17              Driver Version: 572.47         CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 4060 ...    On  |   00000000:01:00.0  On |                  N/A |
| N/A   43C    P5              8W /  115W |    1846MiB /   8188MiB |      9%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
```

## 2 æ£€æŸ¥ `Docker` æ˜¯å¦å®‰è£…

> Docker å®‰è£…å‘½ä»¤: `sudo apt install docker.io`

```shell
âœ docker -v
Docker version 28.0.1, build 068a01e
```

## 3 æ‹‰å– `ollama` é•œåƒ

> è¦æ‹‰å»æŒ‡å®šç‰ˆæœ¬ä½¿ç”¨ `docker pull docker.1ms.run/ollama/ollama:<version>`

```shell
âœ docker pull docker.1ms.run/ollama/ollama
Using default tag: latest
latest: Pulling from ollama/ollama
d9802f032d67: Already exists
161508c220d5: Already exists
a5fe86995597: Pull complete
dfe8fac24641: Pull complete
Digest: sha256:74a0929e1e082a09e4fdeef8594b8f4537f661366a04080e600c90ea9f712721
Status: Downloaded newer image for docker.1ms.run/ollama/ollama:latest
docker.1ms.run/ollama/ollama:latest
```

## 4 å¯åŠ¨ `ollama` é•œåƒ

> å¯åŠ¨å‘½ä»¤ `docker run -d -p <æœ¬åœ°ç«¯å£>:11434 --name <å®¹å™¨åç§°> docker.1ms.run/ollama/ollama`
>
> `-p æœ¬åœ°ç«¯å£:å®¹å™¨ç«¯å£`: æŒ‡å®šç«¯å£æ˜ å°„ (ollamaé»˜è®¤11434)
>
> `-d`: åå°è¿è¡Œ
>
> `--name`: éšä¾¿

å®Œæ•´å‘½ä»¤ç¤ºä¾‹

```shell
docker run -d -p 11434:11434 --name ollama docker.1ms.run/ollama/ollama
```

è¿è¡Œæ•ˆæœ

```shell
âœ docker run -d -p 11434:11434 --name ollama docker.1ms.run/ollama/ollama
latest: Pulling from ollama/ollama
Digest: sha256:74a0929e1e082a09e4fdeef8594b8f4537f661366a04080e600c90ea9f712721
7ea988ec38c46cf2c244ba01c91f1a8e8a2a027511f770735de9987547f0b9ab
```

ä½¿ç”¨ `docker ps` æŸ¥çœ‹æ˜¯å¦è¿è¡ŒæˆåŠŸ

```shell
âœ docker ps
CONTAINER ID   IMAGE                          COMMAND               CREATED          STATUS          PORTS                      NAMES
7ea988ec38c4   docker.1ms.run/ollama/ollama   "/bin/ollama serve"   27 seconds ago   Up 26 seconds   0.0.0.0:11434->11434/tcp   ollama
```

## 5 æ‹‰å–å¹¶è¿è¡ŒæŒ‡å®šæ¨¡å‹

æ¨¡å‹åç§°å¯ä»¥åœ¨ <https://ollama.com/library> æŸ¥çœ‹

### 5.1 è¿›å…¥ `ollama` å®¹å™¨

```shell
# å‘½ä»¤ï¼šdocker exec -it <å®¹å™¨åç§°> bash
âœ docker exec -it ollama bash
root@7ea988ec38c4:/#
```

### 5.2 æ‹‰å–å¹¶è¿è¡Œ `deepseek-r1:1.5b`

```shell
root@7ea988ec38c4:/# ollama run deepseek-r1:1.5b
pulling manifest
pulling aabd4debf0c8... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– 1.1 GB
pulling 369ca498f347... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  387 B
pulling 6e4c38e1172f... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– 1.1 KB
pulling f4d24e9138dd... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  148 B
pulling a85fe2a2e58e... 100% â–•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  487 B
# ç­‰å¾…ä¸‹è½½å®Œæˆ æ›´å¤§ä½“é‡çš„æ¨¡å‹ä¼šæ›´ä¹…
verifying sha256 digest
writing manifest
success
>>> Send a message (/? for help)
```

æµ‹è¯•å¯¹è¯

```markdown
>>> hello
<think>

</think>

Hello! How can I assist you today? ğŸ˜Š

>>> 
```
